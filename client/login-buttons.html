<template name="loginButtons">
    {{#if currentUser}}
      <a href="#" id="login-buttons-logout">
        {{#if currentUser.loading}}
          <span class="loading"></span>
        {{else}}
          {{#if currentUser.name}}
            {{currentUser.name}}
          {{else}}
            {{currentUser.username}}
          {{/if}}
        {{/if}}
        <i class="icon-off icon-white"></i>
      </a>
    {{else}}
      {{#if services}}
        {{#if dropdown}}
          {{> loginButtonsServicesDropdown}}
        {{else}}
          {{> loginButtonsServicesRow}}
        {{/if}}
      {{else}}
        <span class="no-services">No login services configured.</span>
      {{/if}}
    {{/if}}
</template>

<template name="loginButtonsServicesRow">
  {{#each services}}
    {{#if isPasswordService}}
      <form class="login-password-form">
        <label id="login-username-label" for="login-username">Username</label>
        <input id="login-username" type="text" class="span2"/>

        <label id="login-password-label" for="login-password">Password</label>
        <input id="login-password" type="password" class="span2"/>

        {{> loginButtonsServicesRowDynamicPart}}
      </form>
      {{#if hasOtherServices}}
        <div class="or">
          <span class="hline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          <span class="or-text">or</span>
          <span class="hline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
        </div>
      {{/if}}
    {{else}}
      <div class="or">
        <div class="login-button btn btn-inverse" id="login-buttons-{{name}}"><i class="icon-chevron-right icon-white"></i> Use {{name}}</div>
      </div>
    {{/if}}
  {{/each}}
</template>

<!-- needed because of a liveui issue. https://app.asana.com/0/974383817758/1275404875524 -->
<template name="loginButtonsServicesRowDynamicPart">
  {{#if inSignupFlow}}
  <label id="login-password-again-label" for="login-password-again">Password (again)</label>
  <input id="login-password-again" type="password" class="span2"/>
  {{/if}}

  {{#if errorMessage}}
  <div class="error-message">{{errorMessage}}</div>
  {{/if}}

  <div class="login-button btn btn-inverse" id="login-buttons-password">
    {{#if inSignupFlow}}
    Sign up
    {{else}}
    Sign in
    {{/if}}
  </div>

  {{#unless inSignupFlow}}
  <em>or</em> <a id="signup-link">Sign up</a>
  {{/unless}}
</template>

<template name="loginButtonsServicesDropdown">
  <a class="login-link-text"><i class="icon-user icon-white"></i></a>
  {{#if dropdownVisible}}
    <div id="login-dropdown-list">
      <a class="login-close-text"><i class="icon-remove icon-white"></i></a>
      <div class="login-close-text-clear"></div>
      {{> loginButtonsServicesRow}}
    </div>
  {{/if}}
</template>
